#!/usr/bin/env sh

echo "ğŸ” Verificando qualidade do cÃ³digo com dart analyze..."

# Executa anÃ¡lise estÃ¡tica do Dart com warnings E infos fatais
analyze_output=$(dart analyze --fatal-warnings --fatal-infos 2>&1)
analyze_exit_code=$?

# Mostra sempre a saÃ­da do analyze (para transparÃªncia)
if [ -n "$analyze_output" ]; then
  echo "$analyze_output"
fi

# Verifica o resultado do analyze
if [ $analyze_exit_code -eq 0 ]; then
  echo "âœ… CÃ³digo aprovado: Nenhum erro, warning ou info encontrado"
else
  echo ""
  echo "âŒ Commit bloqueado: Encontrados problemas no cÃ³digo"
  echo "ğŸ”§ Para corrigir automaticamente, execute:"
  echo "   dart fix --apply"
  echo ""
  echo "ğŸ” Para verificar manualmente:"
  echo "   dart analyze"
  echo ""
  echo "ğŸ’¡ Dica: Use // ignore: rule_name para ignorar issues especÃ­ficos se necessÃ¡rio"
  echo ""
  exit 1
fi
